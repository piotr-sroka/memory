import{_ as I,x as _,y as h,z as t,d as C,J as se,K as ye,L as oe,M as D,N as be,O as F,P as ie,Q as c,R as z,S as re,T as de,D as ne,U as ke,V as $e,A as M,r as $,o as ce,W as Ce,X as ae,Y as X,B as O,C as S}from"./CIjQJ0AW.js";import{u as Y,a as Pe,f as Se,g as Me}from"./B_zuPOt8.js";const ze={},Ie={class:"container"};function Re(g,o){return h(),_("div",Ie,o[0]||(o[0]=[t("div",{class:"loader"},null,-1)]))}const Ve=I(ze,[["render",Re],["__scopeId","data-v-b9b076da"]]),Le={key:0,class:"dialog fixed flex items-center justify-center w-full h-full"},je={class:"dialog__header flex justify-between items-center"},Ge={class:"flex justify-end mt-6"},Te=C({__name:"TheDialog",props:se({closeAvailable:{type:Boolean,default:!0},maxWidth:{type:String,default:"400px"}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:se(["close"],["update:modelValue"]),setup(g){const o=ye(g,"modelValue");return(u,l)=>o.value?(h(),_("div",Le,[t("div",{class:"dialog__content flex flex-col gap-4 w-full rounded-md px-4 py-6 bg-slate-200 text-zinc-800",style:be({maxWidth:g.maxWidth})},[t("div",je,[D(u.$slots,"header",{},void 0,!0),g.closeAvailable?(h(),_("span",{key:0,class:"dialog__header-close flex items-center justify-center cursor-pointer ml-auto",onClick:l[0]||(l[0]=m=>o.value=!1)}," ✕ ")):oe("",!0)]),l[1]||(l[1]=t("div",{class:"border-b-2 border-b-zinc-700 my-2 w-full h-1"},null,-1)),D(u.$slots,"default",{},void 0,!0),t("div",Ge,[D(u.$slots,"actions",{},void 0,!0)])],4)])):oe("",!0)}}),Be=I(Te,[["__scopeId","data-v-fdebc915"]]),Xe={class:"w-full flex flex-col gap-5"},Ye={class:"flex justify-center items-center w-full gap-5 flex-wrap"},Ne=["disabled"],We={class:"flex justify-center items-center w-full gap-5 flex-wrap"},Ue={class:"levels flex gap-5"},Ee=["value"],Ae={class:"flex gap-5 items-center"},De=C({__name:"GameIntro",setup(g){const o=[{id:"easy",name:"Łatwy"},{id:"medium",name:"Średni"},{id:"hard",name:"Trudny"}],{gameSeed:u,gameLevel:l,startGame:m,trySetGameLevel:f}=Y();function P(){f()}return(i,r)=>(h(),_("div",Xe,[t("div",Ye,[F(t("input",{id:"gameSeed","onUpdate:modelValue":r[0]||(r[0]=n=>z(u)?u.value=n:null),placeholder:"Podaj seeda gry (8 znaków)",type:"text",class:"w-1/2 min-w-64 p-2 text-gray-700",onInput:P},null,544),[[ie,c(u)]]),t("button",{disabled:!c(u),type:"button",class:"btn text-white font-bold",onClick:r[1]||(r[1]=n=>c(m)(!1))}," Graj ",8,Ne)]),t("div",We,[r[5]||(r[5]=t("span",null,"lub wybierz poziom",-1)),t("div",Ue,[(h(),_(re,null,de(o,n=>t("label",{key:n.id,class:ke(["cursor-pointer px-6 py-3 rounded-md border transition-all text-sm font-medium flex items-center justify-center hover:border-orange-900 hover:shadow-sm",{"text-white border-orange-900 shadow-md":c(l)===n.id,"bg-white text-gray-700 border-gray-300":c(l)!==n.id}])},[F(t("input",{"onUpdate:modelValue":r[2]||(r[2]=R=>z(l)?l.value=R:null),type:"radio",name:"levels",value:n.id,class:"sr-only"},null,8,Ee),[[$e,c(l)]]),ne(" "+M(n.name),1)],2)),64))]),t("span",Ae,[r[4]||(r[4]=ne("i ")),t("button",{class:"btn",onClick:r[3]||(r[3]=n=>c(m)(!0))}," Losuj grę ")])])]))}}),Oe=I(De,[["__scopeId","data-v-ae2f18b3"]]),Fe={class:"scores"},He=C({__name:"ScoresList",setup(g){const o=Pe("cs-memory-scores",[],localStorage);return(u,l)=>(h(),_("table",Fe,[l[0]||(l[0]=t("thead",null,[t("th",null,"Imię"),t("th",null,"Poziom"),t("th",null,"Liczba ruchów"),t("th",null,"Czas ukończenia")],-1)),t("tbody",null,[(h(!0),_(re,null,de(c(o),(m,f)=>(h(),_("tr",{key:f},[t("td",null,M(m.userName),1),t("td",null,M(m.gameLevel),1),t("td",null,M(m.moves),1),t("td",null,M(c(Se)(m.time)),1)]))),128))])]))}}),qe=I(He,[["__scopeId","data-v-1d9202d2"]]),le=20,B=12,Je=C({__name:"TheGame",setup(g){const{imagesForGame:o,gameLevel:u,selectImage:l}=Y(),m=$(null),f=$(null),P=$(null),i=$({x:-9999,y:-9999}),r=$(null);let n=0,R=0,V=0,L=0;const N=new Map;function H(){return new Promise(s=>{let e=0;const a=o.value.length;o.value.forEach(p=>{if(N.has(p.id))e++,e===a&&s();else{const d=new Image;d.src=p.image,d.onload=()=>{N.set(p.id,d),e++,e===a&&s()},d.onerror=()=>{e++,e===a&&s()}}})})}function j(){const s=m.value,e=f.value,a=window.devicePixelRatio||1,p=e.clientWidth,d=e.clientHeight;s.width=p*a,s.height=d*a,s.style.width=p+"px",s.style.height=d+"px";const x=s.getContext("2d");x.setTransform(1,0,0,1,0,0),x.scale(a,a),P.value=x;const G=Me[u.value].split("x").map(Number);n=G[0],R=G[1],V=p/n,L=d/R,y()}function y(){const s=m.value,e=P.value;if(!s||!e)return;const a=s.width/(window.devicePixelRatio||1),p=s.height/(window.devicePixelRatio||1);e.clearRect(0,0,a,p),o.value.forEach((d,x)=>{const G=x%n,pe=Math.floor(x/n),b=G*V+B/2,k=pe*L+B/2,v=V-B,w=L-B,Q=b+v/2,Z=k+w/2;e.save();const W=e.createRadialGradient(b+v/2,k+w/2,10,b+v/2,k+w/2,v),he=d.rarity.color;W.addColorStop(0,`${he}${d.solved?"ff":"66"}`),W.addColorStop(1,"#180802"),e.fillStyle=W,e.fillRect(b,k,v,w),d.solved&&(e.strokeStyle="#127c20",e.lineWidth=3,e.strokeRect(b+1,k+1,v-2,w-2)),e.restore();const T=N.get(d.id);if(T){if(e.save(),e.beginPath(),e.roundRect(b+3,k+3,v-6,w-6,0),e.clip(),e.translate(Q,Z),r.value===x){const ve=i.value.x-Q,we=(i.value.y-Z)/w*-le,xe=ve/v*le,_e=we*Math.PI/180,ge=xe*Math.PI/180,ee=Math.tan(ge),te=Math.tan(_e);e.shadowColor="rgba(0,0,0,0.25)",e.shadowBlur=12,e.shadowOffsetX=ee*15,e.shadowOffsetY=te*15,e.transform(1,te*.5,ee*.5,1,0,0),e.scale(1.05,1.05)}e.translate(-v/2,-w/2);const U=T.width/T.height;let E=v,A=w;U>1?A=v/U:E=w*U,e.drawImage(T,(v-E)/2,(w-A)/2,E,A),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.restore()}!d.selected&&!d.solved&&(e.fillStyle="#180802",e.fillRect(b,k,v,w),e.globalAlpha=1)})}function q(s,e){const a=window.devicePixelRatio||1,p=Math.floor(s/a/V),x=Math.floor(e/a/L)*n+p;return x>=0&&x<o.value.length?x:null}function J(s){const e=m.value,a=e.getBoundingClientRect(),p=e.width/a.width,d=e.height/a.height;return{x:(s.clientX-a.left)*p,y:(s.clientY-a.top)*d}}function ue(s){const e=J(s),a=q(e.x,e.y);if(a!==null){const p=o.value[a];l(p),y()}}function me(s){const e=J(s);i.value=e,r.value=q(e.x,e.y),y()}function fe(){r.value=null,y()}function K(){y(),requestAnimationFrame(K)}return ce(async()=>{await H(),j(),K(),window.addEventListener("resize",j)}),Ce(()=>{window.removeEventListener("resize",j)}),ae(o,async()=>{await H(),y()}),ae(u,()=>{j(),y()}),(s,e)=>(h(),_("div",{ref_key:"wrapperRef",ref:f,class:"canvas-wrapper relative w-full max-w-[800px] aspect-square"},[t("canvas",{ref_key:"canvasRef",ref:m,class:"absolute top-0 left-0 w-full h-full",onPointerdown:ue,onPointermove:me,onPointerleave:fe},null,544)],512))}}),Ke=I(Je,[["__scopeId","data-v-d0b91f48"]]),Qe={class:"game w-full h-full flex justify-center items-center"},Ze=["disabled"],et=C({__name:"GameContainer",setup(g){const{gameEnded:o,gameStarted:u,scoresVisible:l,saveScore:m}=Y(),f=$();return(P,i)=>{const r=Be;return h(),_("section",Qe,[c(u)?(h(),X(Ke,{key:1})):(h(),X(Oe,{key:0})),O(r,{modelValue:c(o),"onUpdate:modelValue":i[2]||(i[2]=n=>z(o)?o.value=n:null)},{header:S(()=>i[4]||(i[4]=[t("p",{class:"text-2xl"},"Gratulacje!",-1)])),default:S(()=>[i[5]||(i[5]=t("p",null,"Podaj imię, aby zapisać swój wynik:",-1)),F(t("input",{"onUpdate:modelValue":i[0]||(i[0]=n=>z(f)?f.value=n:null),placeholder:"Podaj imię (minimum 3 znaki)",class:"w-full p-2 text-gray-700"},null,512),[[ie,c(f)]])]),actions:S(()=>[t("button",{disabled:!c(f)||c(f).trim().length<3,class:"btn text-white font-bold",onClick:i[1]||(i[1]=n=>c(m)(c(f)))}," Zapisz ",8,Ze)]),_:1},8,["modelValue"]),O(r,{modelValue:c(l),"onUpdate:modelValue":i[3]||(i[3]=n=>z(l)?l.value=n:null),"max-width":"800px"},{header:S(()=>i[6]||(i[6]=[t("p",{class:"text-2xl"},"Lista wyników",-1)])),default:S(()=>[O(qe)]),_:1},8,["modelValue"])])}}}),nt=C({__name:"index",setup(g){const{images:o,fetchImages:u}=Y();return ce(()=>u()),(l,m)=>{const f=Ve;return c(o).pending?(h(),X(f,{key:0})):(h(),X(et,{key:1}))}}});export{nt as default};
