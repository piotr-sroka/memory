import{_ as T,x as k,y as v,z as l,d as $,J as ee,K as we,L as te,M as U,N as O,O as ae,P as f,Q as G,R as _e,S as ge,D as oe,T as xe,U as ye,A as be,r as M,o as le,V as ke,W as se,X as L,B as Ce,C as D}from"./D79rRZ2X.js";import{u as B,g as Me}from"./BtQ1Nddx.js";const $e={},Re={class:"container"};function Ie(w,n){return v(),k("div",Re,n[0]||(n[0]=[l("div",{class:"loader"},null,-1)]))}const Pe=T($e,[["render",Ie],["__scopeId","data-v-b9b076da"]]),je={key:0,class:"dialog fixed flex items-center justify-center w-full h-full"},Se={class:"dialog__content flex flex-col gap-4 w-full rounded-md px-4 py-6 bg-slate-200 text-zinc-800"},ze={class:"dialog__header flex justify-between items-center"},Ve={class:"flex justify-end mt-6"},Ge=$({__name:"TheDialog",props:ee({closeAvailable:{type:Boolean,default:!0}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:ee(["close"],["update:modelValue"]),setup(w){const n=we(w,"modelValue");return(r,d)=>n.value?(v(),k("div",je,[l("div",Se,[l("div",ze,[U(r.$slots,"header",{},void 0,!0),w.closeAvailable?(v(),k("span",{key:0,class:"dialog__header-close flex items-center justify-center cursor-pointer ml-auto",onClick:d[0]||(d[0]=i=>n.value=!1)}," ✕ ")):te("",!0)]),d[1]||(d[1]=l("div",{class:"border-b-2 border-b-zinc-700 my-2 w-full h-1"},null,-1)),U(r.$slots,"default",{},void 0,!0),l("div",Ve,[U(r.$slots,"actions",{},void 0,!0)])])])):te("",!0)}}),Le=T(Ge,[["__scopeId","data-v-a57486dc"]]),Te={class:"w-full flex flex-col gap-5"},Be={class:"flex justify-center items-center w-full gap-5 flex-wrap"},Xe=["disabled"],Ye={class:"flex justify-center items-center w-full gap-5 flex-wrap"},Ne={class:"levels flex gap-5"},Ae=["value"],Ee={class:"flex gap-5 items-center"},Ue=$({__name:"GameIntro",setup(w){const n=[{id:"easy",name:"Łatwy"},{id:"medium",name:"Średni"},{id:"hard",name:"Trudny"}],{gameSeed:r,gameLevel:d,startGame:i,trySetGameLevel:_}=B();function c(){_()}return(C,o)=>(v(),k("div",Te,[l("div",Be,[O(l("input",{id:"gameSeed","onUpdate:modelValue":o[0]||(o[0]=u=>G(r)?r.value=u:null),placeholder:"Podaj seeda gry (8 znaków)",type:"text",class:"w-1/2 min-w-64 p-2 text-gray-700",onInput:c},null,544),[[ae,f(r)]]),l("button",{disabled:!f(r),type:"button",class:"btn text-white font-bold",onClick:o[1]||(o[1]=u=>f(i)(!1))}," Graj ",8,Xe)]),l("div",Ye,[o[5]||(o[5]=l("span",null,"lub wybierz poziom",-1)),l("div",Ne,[(v(),k(_e,null,ge(n,u=>l("label",{key:u.id,class:xe(["cursor-pointer px-6 py-3 rounded-md border transition-all text-sm font-medium flex items-center justify-center hover:border-orange-900 hover:shadow-sm",{"text-white border-orange-900 shadow-md":f(d)===u.id,"bg-white text-gray-700 border-gray-300":f(d)!==u.id}])},[O(l("input",{"onUpdate:modelValue":o[2]||(o[2]=R=>G(d)?d.value=R:null),type:"radio",name:"levels",value:u.id,class:"sr-only"},null,8,Ae),[[ye,f(d)]]),oe(" "+be(u.name),1)],2)),64))]),l("span",Ee,[o[4]||(o[4]=oe("i ")),l("button",{class:"btn",onClick:o[3]||(o[3]=u=>f(i)(!0))}," Losuj grę ")])])]))}}),De=T(Ue,[["__scopeId","data-v-ae2f18b3"]]),ne=20,V=12,Oe=$({__name:"TheGame",setup(w){const{imagesForGame:n,gameLevel:r,selectImage:d}=B(),i=M(null),_=M(null),c=M(null),C=M({x:-9999,y:-9999}),o=M(null);let u=0,R=0,I=0,P=0;const X=new Map;function W(){return new Promise(t=>{let e=0;const a=n.value.length;n.value.forEach(m=>{if(X.has(m.id))e++,e===a&&t();else{const s=new Image;s.src=m.image,s.onload=()=>{X.set(m.id,s),e++,e===a&&t()},s.onerror=()=>{e++,e===a&&t()}}})})}function j(){const t=i.value,e=_.value,a=window.devicePixelRatio||1,m=e.offsetWidth,s=e.offsetHeight;t.width=m*a,t.height=s*a,t.style.width=m+"px",t.style.height=s+"px";const x=t.getContext("2d");x.setTransform(1,0,0,1,0,0),x.scale(a,a),c.value=x;const S=Me[r.value].split("x").map(Number);u=S[0],R=S[1],I=m/u,P=s/R,g()}function g(){const t=i.value,e=c.value;if(!t||!e)return;const a=t.width/(window.devicePixelRatio||1),m=t.height/(window.devicePixelRatio||1);e.clearRect(0,0,a,m),n.value.forEach((s,x)=>{const S=x%u,ce=Math.floor(x/u),y=S*I+V/2,b=ce*P+V/2,p=I-V,h=P-V,J=y+p/2,K=b+h/2;e.save();const Y=e.createRadialGradient(y+p/2,b+h/2,10,y+p/2,b+h/2,p),ue=s.rarity.color;Y.addColorStop(0,`${ue}${s.solved?"ff":"66"}`),Y.addColorStop(1,"#180802"),e.fillStyle=Y,e.fillRect(y,b,p,h),s.solved&&(e.strokeStyle="#127c20",e.lineWidth=3,e.strokeRect(y+1,b+1,p-2,h-2)),e.restore();const z=X.get(s.id);if(z){if(e.save(),e.beginPath(),e.roundRect(y+3,b+3,p-6,h-6,0),e.clip(),e.translate(J,K),o.value===x){const fe=C.value.x-J,me=(C.value.y-K)/h*-ne,pe=fe/p*ne,he=me*Math.PI/180,ve=pe*Math.PI/180,Q=Math.tan(ve),Z=Math.tan(he);e.shadowColor="rgba(0,0,0,0.25)",e.shadowBlur=12,e.shadowOffsetX=Q*15,e.shadowOffsetY=Z*15,e.transform(1,Z*.5,Q*.5,1,0,0),e.scale(1.05,1.05)}e.translate(-p/2,-h/2);const N=z.width/z.height;let A=p,E=h;N>1?E=p/N:A=h*N,e.drawImage(z,(p-A)/2,(h-E)/2,A,E),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.restore()}!s.selected&&!s.solved&&(e.fillStyle="#180802",e.globalAlpha=.5,e.fillRect(y,b,p,h),e.globalAlpha=1)})}function F(t,e){const a=Math.floor(t/I),s=Math.floor(e/P)*u+a;return s>=0&&s<n.value.length?s:null}function H(t){const e=i.value,a=e.getBoundingClientRect(),m=e.width/a.width,s=e.height/a.height;return{x:(t.clientX-a.left)*m,y:(t.clientY-a.top)*s}}function ie(t){const e=H(t),a=F(e.x,e.y);if(a!==null){const m=n.value[a];d(m),g()}}function re(t){const e=H(t);C.value=e,o.value=F(e.x,e.y),g()}function de(){o.value=null,g()}function q(){g(),requestAnimationFrame(q)}return le(async()=>{await W(),j(),q(),window.addEventListener("resize",j)}),ke(()=>{window.removeEventListener("resize",j)}),se(n,async()=>{await W(),g()}),se(r,()=>{j(),g()}),(t,e)=>(v(),k("div",{ref_key:"wrapperRef",ref:_,class:"canvas-wrapper relative w-full max-w-[800px] aspect-square"},[l("canvas",{ref_key:"canvasRef",ref:i,class:"absolute top-0 left-0 w-full h-full",onClick:ie,onMousemove:re,onMouseleave:de},null,544)],512))}}),We=T(Oe,[["__scopeId","data-v-4a4e958c"]]),Fe={class:"game w-full h-full flex justify-center items-center"},He=["disabled"],qe=$({__name:"GameContainer",setup(w){const{gameEnded:n,gameStarted:r,saveScore:d}=B(),i=M();return(_,c)=>{const C=Le;return v(),k("section",Fe,[f(r)?(v(),L(We,{key:1})):(v(),L(De,{key:0})),Ce(C,{modelValue:f(n),"onUpdate:modelValue":c[2]||(c[2]=o=>G(n)?n.value=o:null)},{header:D(()=>c[3]||(c[3]=[l("p",{class:"text-2xl"},"Gratulacje!",-1)])),default:D(()=>[c[4]||(c[4]=l("p",null,"Podaj imię, aby zapisać swój wynik:",-1)),O(l("input",{"onUpdate:modelValue":c[0]||(c[0]=o=>G(i)?i.value=o:null),placeholder:"Podaj imię (minimum 3 znaki)",class:"w-full p-2 text-gray-700"},null,512),[[ae,f(i)]])]),actions:D(()=>[l("button",{disabled:!f(i)||f(i).trim().length<3,class:"btn text-white font-bold",onClick:c[1]||(c[1]=o=>f(d)(f(i)))}," Zapisz ",8,He)]),_:1},8,["modelValue"])])}}}),Ze=$({__name:"index",setup(w){const{images:n,fetchImages:r}=B();return le(()=>r()),(d,i)=>{const _=Pe;return f(n).pending?(v(),L(_,{key:0})):(v(),L(qe,{key:1}))}}});export{Ze as default};
