import{_ as T,x as k,y as w,z as a,d as M,J as ee,K as we,L as te,M as A,N as O,O as ae,P as m,Q as G,R as _e,S as ge,D as oe,T as xe,U as ye,A as be,r as C,o as le,V as ke,W as se,X as L,B as $e,C as D}from"./DvNJiiLJ.js";import{u as B,g as Ce}from"./DpucFvm1.js";const Me={},Pe={class:"container"};function Re(_,n){return w(),k("div",Pe,n[0]||(n[0]=[a("div",{class:"loader"},null,-1)]))}const Ie=T(Me,[["render",Re],["__scopeId","data-v-b9b076da"]]),je={key:0,class:"dialog fixed flex items-center justify-center w-full h-full"},Se={class:"dialog__content flex flex-col gap-4 w-full rounded-md px-4 py-6 bg-slate-200 text-zinc-800"},ze={class:"dialog__header flex justify-between items-center"},Ve={class:"flex justify-end mt-6"},Ge=M({__name:"TheDialog",props:ee({closeAvailable:{type:Boolean,default:!0}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:ee(["close"],["update:modelValue"]),setup(_){const n=we(_,"modelValue");return(r,d)=>n.value?(w(),k("div",je,[a("div",Se,[a("div",ze,[A(r.$slots,"header",{},void 0,!0),_.closeAvailable?(w(),k("span",{key:0,class:"dialog__header-close flex items-center justify-center cursor-pointer ml-auto",onClick:d[0]||(d[0]=i=>n.value=!1)}," ✕ ")):te("",!0)]),d[1]||(d[1]=a("div",{class:"border-b-2 border-b-zinc-700 my-2 w-full h-1"},null,-1)),A(r.$slots,"default",{},void 0,!0),a("div",Ve,[A(r.$slots,"actions",{},void 0,!0)])])])):te("",!0)}}),Le=T(Ge,[["__scopeId","data-v-a57486dc"]]),Te={class:"w-full flex flex-col gap-5"},Be={class:"flex justify-center items-center w-full gap-5 flex-wrap"},Xe=["disabled"],Ye={class:"flex justify-center items-center w-full gap-5 flex-wrap"},Ne={class:"levels flex gap-5"},Ee=["value"],Ue={class:"flex gap-5 items-center"},Ae=M({__name:"GameIntro",setup(_){const n=[{id:"easy",name:"Łatwy"},{id:"medium",name:"Średni"},{id:"hard",name:"Trudny"}],{gameSeed:r,gameLevel:d,startGame:i,trySetGameLevel:g}=B();function c(){g()}return($,o)=>(w(),k("div",Te,[a("div",Be,[O(a("input",{id:"gameSeed","onUpdate:modelValue":o[0]||(o[0]=u=>G(r)?r.value=u:null),placeholder:"Podaj seeda gry (8 znaków)",type:"text",class:"w-1/2 min-w-64 p-2 text-gray-700",onInput:c},null,544),[[ae,m(r)]]),a("button",{disabled:!m(r),type:"button",class:"btn text-white font-bold",onClick:o[1]||(o[1]=u=>m(i)(!1))}," Graj ",8,Xe)]),a("div",Ye,[o[5]||(o[5]=a("span",null,"lub wybierz poziom",-1)),a("div",Ne,[(w(),k(_e,null,ge(n,u=>a("label",{key:u.id,class:xe(["cursor-pointer px-6 py-3 rounded-md border transition-all text-sm font-medium flex items-center justify-center hover:border-orange-900 hover:shadow-sm",{"text-white border-orange-900 shadow-md":m(d)===u.id,"bg-white text-gray-700 border-gray-300":m(d)!==u.id}])},[O(a("input",{"onUpdate:modelValue":o[2]||(o[2]=P=>G(d)?d.value=P:null),type:"radio",name:"levels",value:u.id,class:"sr-only"},null,8,Ee),[[ye,m(d)]]),oe(" "+be(u.name),1)],2)),64))]),a("span",Ue,[o[4]||(o[4]=oe("i ")),a("button",{class:"btn",onClick:o[3]||(o[3]=u=>m(i)(!0))}," Losuj grę ")])])]))}}),De=T(Ae,[["__scopeId","data-v-ae2f18b3"]]),ne=20,V=12,Oe=M({__name:"TheGame",setup(_){const{imagesForGame:n,gameLevel:r,selectImage:d}=B(),i=C(null),g=C(null),c=C(null),$=C({x:-9999,y:-9999}),o=C(null);let u=0,P=0,R=0,I=0;const X=new Map;function W(){return new Promise(t=>{let e=0;const s=n.value.length;n.value.forEach(f=>{if(X.has(f.id))e++,e===s&&t();else{const l=new Image;l.src=f.image,l.onload=()=>{X.set(f.id,l),e++,e===s&&t()},l.onerror=()=>{e++,e===s&&t()}}})})}function j(){const t=i.value,e=g.value,s=window.devicePixelRatio||1,f=e.clientWidth,l=e.clientHeight;t.width=f*s,t.height=l*s,t.style.width=f+"px",t.style.height=l+"px";const h=t.getContext("2d");h.setTransform(1,0,0,1,0,0),h.scale(s,s),c.value=h;const S=Ce[r.value].split("x").map(Number);u=S[0],P=S[1],R=f/u,I=l/P,x()}function x(){const t=i.value,e=c.value;if(!t||!e)return;const s=t.width/(window.devicePixelRatio||1),f=t.height/(window.devicePixelRatio||1);e.clearRect(0,0,s,f),n.value.forEach((l,h)=>{const S=h%u,ce=Math.floor(h/u),y=S*R+V/2,b=ce*I+V/2,p=R-V,v=I-V,J=y+p/2,K=b+v/2;e.save();const Y=e.createRadialGradient(y+p/2,b+v/2,10,y+p/2,b+v/2,p),ue=l.rarity.color;Y.addColorStop(0,`${ue}${l.solved?"ff":"66"}`),Y.addColorStop(1,"#180802"),e.fillStyle=Y,e.fillRect(y,b,p,v),l.solved&&(e.strokeStyle="#127c20",e.lineWidth=3,e.strokeRect(y+1,b+1,p-2,v-2)),e.restore();const z=X.get(l.id);if(z){if(e.save(),e.beginPath(),e.roundRect(y+3,b+3,p-6,v-6,0),e.clip(),e.translate(J,K),o.value===h){const fe=$.value.x-J,me=($.value.y-K)/v*-ne,pe=fe/p*ne,ve=me*Math.PI/180,he=pe*Math.PI/180,Q=Math.tan(he),Z=Math.tan(ve);e.shadowColor="rgba(0,0,0,0.25)",e.shadowBlur=12,e.shadowOffsetX=Q*15,e.shadowOffsetY=Z*15,e.transform(1,Z*.5,Q*.5,1,0,0),e.scale(1.05,1.05)}e.translate(-p/2,-v/2);const N=z.width/z.height;let E=p,U=v;N>1?U=p/N:E=v*N,e.drawImage(z,(p-E)/2,(v-U)/2,E,U),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.restore()}!l.selected&&!l.solved&&(e.fillStyle="#180802",e.fillRect(y,b,p,v),e.globalAlpha=1)})}function F(t,e){const s=window.devicePixelRatio||1,f=Math.floor(t/s/R),h=Math.floor(e/s/I)*u+f;return h>=0&&h<n.value.length?h:null}function H(t){const e=i.value,s=e.getBoundingClientRect(),f=e.width/s.width,l=e.height/s.height;return{x:(t.clientX-s.left)*f,y:(t.clientY-s.top)*l}}function ie(t){const e=H(t),s=F(e.x,e.y);if(s!==null){const f=n.value[s];d(f),x()}}function re(t){const e=H(t);$.value=e,o.value=F(e.x,e.y),x()}function de(){o.value=null,x()}function q(){x(),requestAnimationFrame(q)}return le(async()=>{await W(),j(),q(),window.addEventListener("resize",j)}),ke(()=>{window.removeEventListener("resize",j)}),se(n,async()=>{await W(),x()}),se(r,()=>{j(),x()}),(t,e)=>(w(),k("div",{ref_key:"wrapperRef",ref:g,class:"canvas-wrapper relative w-full max-w-[800px] aspect-square"},[a("canvas",{ref_key:"canvasRef",ref:i,class:"absolute top-0 left-0 w-full h-full",onPointerdown:ie,onPointermove:re,onPointerleave:de},null,544)],512))}}),We=T(Oe,[["__scopeId","data-v-d0b91f48"]]),Fe={class:"game w-full h-full flex justify-center items-center"},He=["disabled"],qe=M({__name:"GameContainer",setup(_){const{gameEnded:n,gameStarted:r,saveScore:d}=B(),i=C();return(g,c)=>{const $=Le;return w(),k("section",Fe,[m(r)?(w(),L(We,{key:1})):(w(),L(De,{key:0})),$e($,{modelValue:m(n),"onUpdate:modelValue":c[2]||(c[2]=o=>G(n)?n.value=o:null)},{header:D(()=>c[3]||(c[3]=[a("p",{class:"text-2xl"},"Gratulacje!",-1)])),default:D(()=>[c[4]||(c[4]=a("p",null,"Podaj imię, aby zapisać swój wynik:",-1)),O(a("input",{"onUpdate:modelValue":c[0]||(c[0]=o=>G(i)?i.value=o:null),placeholder:"Podaj imię (minimum 3 znaki)",class:"w-full p-2 text-gray-700"},null,512),[[ae,m(i)]])]),actions:D(()=>[a("button",{disabled:!m(i)||m(i).trim().length<3,class:"btn text-white font-bold",onClick:c[1]||(c[1]=o=>m(d)(m(i)))}," Zapisz ",8,He)]),_:1},8,["modelValue"])])}}}),Ze=M({__name:"index",setup(_){const{images:n,fetchImages:r}=B();return le(()=>r()),(d,i)=>{const g=Ie;return m(n).pending?(w(),L(g,{key:0})):(w(),L(qe,{key:1}))}}});export{Ze as default};
