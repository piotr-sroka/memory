import{Y as Z,Z as K,W as V,$ as ue,a0 as se,a1 as ie,r as Q,a2 as ce,o as X,a3 as ee,s as L,a4 as fe,a5 as C,k as $,P as de,a6 as ve,a7 as me,a8 as pe,a as Y}from"./DvNJiiLJ.js";function te(e){return ue()?(se(e),!0):!1}const R=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const N=e=>e!=null,ge=Object.prototype.toString,ye=e=>ge.call(e)==="[object Object]",he=()=>{};function Se(...e){if(e.length!==1)return ie(...e);const t=e[0];return typeof t=="function"?K(ce(()=>({get:t,set:he}))):Q(t)}function we(e,t){function n(...r){return new Promise((u,o)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(u).catch(o)})}return n}const ne=e=>e();function be(e=ne,t={}){const{initialState:n="active"}=t,r=Se(n==="active");function u(){r.value=!1}function o(){r.value=!0}const s=(...a)=>{r.value&&e(...a)};return{isActive:K(r),pause:u,resume:o,eventFilter:s}}function Ee(e){let t;function n(){return t||(t=e()),t}return n.reset=async()=>{const r=t;t=void 0,r&&await r},n}function z(e){return Array.isArray(e)?e:[e]}function Te(e){return ee()}function Ae(e,t,n={}){const{eventFilter:r=ne,...u}=n;return V(e,we(r,t),u)}function Me(e,t,n={}){const{eventFilter:r,initialState:u="active",...o}=n,{eventFilter:s,pause:a,resume:l,isActive:c}=be(r,{initialState:u});return{stop:Ae(e,t,{...o,eventFilter:s}),pause:a,resume:l,isActive:c}}function Oe(e,t=!0,n){Te()?X(e,n):t?e():Z(e)}function Ie(e,t,n={}){const{immediate:r=!0,immediateCallback:u=!1}=n,o=L(!1);let s;function a(){s&&(clearTimeout(s),s=void 0)}function l(){o.value=!1,a()}function c(...v){u&&e(),a(),o.value=!0,s=setTimeout(()=>{o.value=!1,s=void 0,e(...v)},C(t))}return r&&(o.value=!0,R&&c()),te(l),{isPending:fe(o),start:c,stop:l}}function Ce(e,t,n){return V(e,t,{...n,immediate:!0})}const B=R?window:void 0,ae=R?window.navigator:void 0;function xe(e){var t;const n=C(e);return(t=n==null?void 0:n.$el)!=null?t:n}function W(...e){const t=[],n=()=>{t.forEach(a=>a()),t.length=0},r=(a,l,c,v)=>(a.addEventListener(l,c,v),()=>a.removeEventListener(l,c,v)),u=$(()=>{const a=z(C(e[0])).filter(l=>l!=null);return a.every(l=>typeof l!="string")?a:void 0}),o=Ce(()=>{var a,l;return[(l=(a=u.value)==null?void 0:a.map(c=>xe(c)))!=null?l:[B].filter(c=>c!=null),z(C(u.value?e[1]:e[0])),z(de(u.value?e[2]:e[1])),C(u.value?e[3]:e[2])]},([a,l,c,v])=>{if(n(),!(a!=null&&a.length)||!(l!=null&&l.length)||!(c!=null&&c.length))return;const p=ye(v)?{...v}:v;t.push(...a.flatMap(x=>l.flatMap(A=>c.map(M=>r(x,A,M,p)))))},{flush:"post"}),s=()=>{o(),n()};return te(n),s}function Le(){const e=L(!1),t=ee();return t&&X(()=>{e.value=!0},t),e}function oe(e){const t=Le();return $(()=>(t.value,!!e()))}function H(e,t={}){const{controls:n=!1,navigator:r=ae}=t,u=oe(()=>r&&"permissions"in r),o=L(),s=typeof e=="string"?{name:e}:e,a=L(),l=()=>{var v,p;a.value=(p=(v=o.value)==null?void 0:v.state)!=null?p:"prompt"};W(o,"change",l,{passive:!0});const c=Ee(async()=>{if(u.value){if(!o.value)try{o.value=await r.permissions.query(s)}catch{o.value=void 0}finally{l()}if(n)return ve(o.value)}});return c(),n?{state:a,isSupported:u,query:c}:a}function He(e={}){const{navigator:t=ae,read:n=!1,source:r,copiedDuring:u=1500,legacy:o=!1}=e,s=oe(()=>t&&"clipboard"in t),a=H("clipboard-read"),l=H("clipboard-write"),c=$(()=>s.value||o),v=L(""),p=L(!1),x=Ie(()=>p.value=!1,u,{immediate:!1});async function A(){let d=!(s.value&&h(a.value));if(!d)try{v.value=await t.clipboard.readText()}catch{d=!0}d&&(v.value=b())}c.value&&n&&W(["copy","cut"],A,{passive:!0});async function M(d=C(r)){if(c.value&&d!=null){let m=!(s.value&&h(l.value));if(!m)try{await t.clipboard.writeText(d)}catch{m=!0}m&&E(d),v.value=d,p.value=!0,x.start()}}function E(d){const m=document.createElement("textarea");m.value=d??"",m.style.position="absolute",m.style.opacity="0",document.body.appendChild(m),m.select(),document.execCommand("copy"),m.remove()}function b(){var d,m,f;return(f=(m=(d=document==null?void 0:document.getSelection)==null?void 0:d.call(document))==null?void 0:m.toString())!=null?f:""}function h(d){return d==="granted"||d==="prompt"}return{isSupported:c,text:v,copied:p,copy:M}}const _=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P="__vueuse_ssr_handlers__",Ne=Fe();function Fe(){return P in _||(_[P]=_[P]||{}),_[P]}function Re(e,t){return Ne[e]||t}function je(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const ke={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},U="vueuse-storage";function le(e,t,n,r={}){var u;const{flush:o="pre",deep:s=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:c=!1,shallow:v,window:p=B,eventFilter:x,onError:A=i=>{console.error(i)},initOnMounted:M}=r,E=(v?L:Q)(typeof t=="function"?t():t),b=$(()=>C(e));if(!n)try{n=Re("getDefaultStorage",()=>{var i;return(i=B)==null?void 0:i.localStorage})()}catch(i){A(i)}if(!n)return E;const h=C(t),d=je(h),m=(u=r.serializer)!=null?u:ke[d],{pause:f,resume:S}=Me(E,()=>k(E.value),{flush:o,deep:s,eventFilter:x});V(b,()=>I(),{flush:o});let w=!1;const G=i=>{M&&!w||I(i)},J=i=>{M&&!w||re(i)};p&&a&&(n instanceof Storage?W(p,"storage",G,{passive:!0}):W(p,U,J)),M?Oe(()=>{w=!0,I()}):I();function j(i,g){if(p){const T={key:b.value,oldValue:i,newValue:g,storageArea:n};p.dispatchEvent(n instanceof Storage?new StorageEvent("storage",T):new CustomEvent(U,{detail:T}))}}function k(i){try{const g=n.getItem(b.value);if(i==null)j(g,null),n.removeItem(b.value);else{const T=m.write(i);g!==T&&(n.setItem(b.value,T),j(g,T))}}catch(g){A(g)}}function O(i){const g=i?i.newValue:n.getItem(b.value);if(g==null)return l&&h!=null&&n.setItem(b.value,m.write(h)),h;if(!i&&c){const T=m.read(g);return typeof c=="function"?c(T,h):d==="object"&&!Array.isArray(T)?{...h,...T}:T}else return typeof g!="string"?g:m.read(g)}function I(i){if(!(i&&i.storageArea!==n)){if(i&&i.key==null){E.value=h;return}if(!(i&&i.key!==b.value)){f();try{(i==null?void 0:i.newValue)!==m.write(E.value)&&(E.value=O(i))}catch(g){A(g)}finally{i?Z(S):S()}}}}function re(i){I(i.detail)}return E}async function _e(){return await $fetch("https://raw.githubusercontent.com/ByMykel/CSGO-API/main/public/api/en/skins.json",{responseType:"json"})}var D=(e=>(e.EASY="easy",e.MEDIUM="medium",e.HARD="hard",e))(D||{});const Pe={easy:"3x4",medium:"4x4",hard:"5x6"};function We(){const e="0123456789abcdef";let t="";for(let n=0;n<8;n++)t+=e[Math.floor(Math.random()*e.length)];return t}function De(e){return function(){let t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}function $e(e){let t=0;for(let n=0;n<e.length;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function q(e,t,n){const r=t??We(),u=t??`${r}-${n}`,o=De($e(u)),s=[...e];for(let a=s.length-1;a>0;a--){const l=Math.floor(o()*(a+1));[s[a],s[l]]=[s[l],s[a]]}return{shuffled:s,seed:u}}const Ge=""+new URL("selected.BxcsJQ8g.mp3",import.meta.url).href,Je=""+new URL("solved.CZ6_Op3f.mp3",import.meta.url).href,F={selected:new Audio(Ge),solved:new Audio(Je)},ze=window.setInterval,Be=pe({gameEnded:!1,gameLevel:D.EASY,gameSeed:null,gameStarted:!1,images:{data:null,error:null,pending:!1},imagesForGame:[],moves:0,selectedImages:[],time:0,timer:null}),y=le("cs-memory-current-session",{},localStorage),Ve=le("cs-memory-scores",[],localStorage);function Ue(){const{gameEnded:e,gameLevel:t,gameSeed:n,gameStarted:r,images:u,imagesForGame:o,moves:s,selectedImages:a,time:l,timer:c}=me(Be);async function v(){u.value.pending=!0;try{const f=await _e();f&&(u.value.data=f)}catch(f){f&&(u.value.error=f)}finally{setTimeout(()=>{u.value.pending=!1},1e3)}y.value&&N(y.value.gameSeed)&&N(y.value.gameLevel)&&N(y.value.moves)&&N(y.value.solvedImages)&&N(y.value.time)&&(n.value=y.value.gameSeed,t.value=y.value.gameLevel,s.value=y.value.moves,l.value=y.value.time,p(!1))}function p(f=!1){if(u.value.data){if(f&&(n.value=null),!A()){R&&Y().$toast.error("Niepoprawny seed",{position:"top-center"});return}const[S,w]=Pe[t.value].split("x").map(Number),G=S*w,{seed:J,shuffled:j}=q(u.value.data,n.value,t.value),k=[...j.slice(0,G/2)];o.value=q([...k,...k.map(O=>({...O,id:`${O.id}----copy`}))],n.value,t.value).shuffled,y.value&&N(y.value.solvedImages)&&o.value.forEach(O=>{var I;(I=y.value.solvedImages)!=null&&I.includes(O.id)&&(O.solved=!0)}),n.value=J,r.value=!0,o.value.every(O=>O.solved)||b()}}function x(){e.value=!1,t.value=D.EASY,n.value=null,r.value=!1,s.value=0,l.value=0,a.value=[],y.value={},o.value.forEach(f=>{f.solved=!1}),h()}function A(){if(n.value){const f=n.value.split("-"),S=f[f.length-1];return Object.values(D).includes(S)?(t.value=S,!0):!1}return!0}function M(f){if(a.value.length===2||o.value.every(w=>w.solved))return;F.selected.pause(),F.selected.currentTime=0,F.selected.play(),s.value++;const S=a.value.find(w=>w.id===f.id);S?(a.value.splice(a.value.indexOf(S),1),S.selected=!1):(f.selected=!0,a.value.push(f)),a.value.length===2&&(a.value[0].id.replace("----copy","")===a.value[1].id.replace("----copy","")&&(F.solved.pause(),F.solved.currentTime=0,F.solved.play(),a.value.forEach(w=>w.solved=!0)),setTimeout(()=>{a.value.forEach(w=>w.selected=!1),a.value=[]},500)),E()}function E(){o.value.every(f=>f.solved)&&(d(),h(),setTimeout(()=>{R&&Y().$toast.success("gratulacje!",{position:"top-center"})},500),setTimeout(()=>{e.value=!0},1500))}function b(){c.value=ze(()=>{d(),l.value++},1e3)}function h(){c.value&&clearInterval(c.value)}function d(){y.value={gameSeed:n.value,gameLevel:t.value,moves:s.value,solvedImages:o.value.filter(f=>f.solved).map(f=>f.id),time:l.value}}function m(f){const S={date:new Date().toISOString(),userName:f,gameLevel:t.value,moves:s.value,time:l.value};Ve.value.push(S),e.value=!1}return{gameEnded:e,gameLevel:t,gameSeed:n,gameStarted:r,images:u,imagesForGame:o,moves:s,selectedImages:a,time:l,fetchImages:v,saveScore:m,selectImage:M,startGame:p,resetGame:x,trySetGameLevel:A}}export{He as a,Pe as g,Ue as u};
