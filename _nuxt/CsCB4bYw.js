import{Z,$ as K,X as H,a0 as ue,a1 as se,a2 as ie,r as X,a3 as ce,o as ee,a4 as te,s as N,a5 as fe,a6 as x,k as G,Q as de,a7 as ve,a8 as me,a9 as pe,a as U}from"./BpQMZUua.js";function ne(e){return ue()?(se(e),!0):!1}const j=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const F=e=>e!=null,ge=Object.prototype.toString,ye=e=>ge.call(e)==="[object Object]",he=()=>{};function Se(...e){if(e.length!==1)return ie(...e);const t=e[0];return typeof t=="function"?K(ce(()=>({get:t,set:he}))):X(t)}function we(e,t){function n(...r){return new Promise((s,l)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(s).catch(l)})}return n}const ae=e=>e();function be(e=ae,t={}){const{initialState:n="active"}=t,r=Se(n==="active");function s(){r.value=!1}function l(){r.value=!0}const i=(...o)=>{r.value&&e(...o)};return{isActive:K(r),pause:s,resume:l,eventFilter:i}}function Ee(e){let t;function n(){return t||(t=e()),t}return n.reset=async()=>{const r=t;t=void 0,r&&await r},n}function z(e){return Array.isArray(e)?e:[e]}function Te(e){return te()}function Ae(e,t,n={}){const{eventFilter:r=ae,...s}=n;return H(e,we(r,t),s)}function Me(e,t,n={}){const{eventFilter:r,initialState:s="active",...l}=n,{eventFilter:i,pause:o,resume:a,isActive:c}=be(r,{initialState:s});return{stop:Ae(e,t,{...l,eventFilter:i}),pause:o,resume:a,isActive:c}}function Oe(e,t=!0,n){Te()?ee(e,n):t?e():Z(e)}function Ie(e,t,n={}){const{immediate:r=!0,immediateCallback:s=!1}=n,l=N(!1);let i;function o(){i&&(clearTimeout(i),i=void 0)}function a(){l.value=!1,o()}function c(...d){s&&e(),o(),l.value=!0,i=setTimeout(()=>{l.value=!1,i=void 0,e(...d)},x(t))}return r&&(l.value=!0,j&&c()),ne(a),{isPending:fe(l),start:c,stop:a}}function Ce(e,t,n){return H(e,t,{...n,immediate:!0})}const B=j?window:void 0,oe=j?window.navigator:void 0;function xe(e){var t;const n=x(e);return(t=n==null?void 0:n.$el)!=null?t:n}function W(...e){const t=[],n=()=>{t.forEach(o=>o()),t.length=0},r=(o,a,c,d)=>(o.addEventListener(a,c,d),()=>o.removeEventListener(a,c,d)),s=G(()=>{const o=z(x(e[0])).filter(a=>a!=null);return o.every(a=>typeof a!="string")?o:void 0}),l=Ce(()=>{var o,a;return[(a=(o=s.value)==null?void 0:o.map(c=>xe(c)))!=null?a:[B].filter(c=>c!=null),z(x(s.value?e[1]:e[0])),z(de(s.value?e[2]:e[1])),x(s.value?e[3]:e[2])]},([o,a,c,d])=>{if(n(),!(o!=null&&o.length)||!(a!=null&&a.length)||!(c!=null&&c.length))return;const p=ye(d)?{...d}:d;t.push(...o.flatMap(I=>a.flatMap(M=>c.map(A=>r(I,M,A,p)))))},{flush:"post"}),i=()=>{l(),n()};return ne(n),i}function Le(){const e=N(!1),t=te();return t&&ee(()=>{e.value=!0},t),e}function re(e){const t=Le();return G(()=>(t.value,!!e()))}function Y(e,t={}){const{controls:n=!1,navigator:r=oe}=t,s=re(()=>r&&"permissions"in r),l=N(),i=typeof e=="string"?{name:e}:e,o=N(),a=()=>{var d,p;o.value=(p=(d=l.value)==null?void 0:d.state)!=null?p:"prompt"};W(l,"change",a,{passive:!0});const c=Ee(async()=>{if(s.value){if(!l.value)try{l.value=await r.permissions.query(i)}catch{l.value=void 0}finally{a()}if(n)return ve(l.value)}});return c(),n?{state:o,isSupported:s,query:c}:o}function Ue(e={}){const{navigator:t=oe,read:n=!1,source:r,copiedDuring:s=1500,legacy:l=!1}=e,i=re(()=>t&&"clipboard"in t),o=Y("clipboard-read"),a=Y("clipboard-write"),c=G(()=>i.value||l),d=N(""),p=N(!1),I=Ie(()=>p.value=!1,s,{immediate:!1});async function M(){let v=!(i.value&&S(o.value));if(!v)try{d.value=await t.clipboard.readText()}catch{v=!0}v&&(d.value=h())}c.value&&n&&W(["copy","cut"],M,{passive:!0});async function A(v=x(r)){if(c.value&&v!=null){let m=!(i.value&&S(a.value));if(!m)try{await t.clipboard.writeText(v)}catch{m=!0}m&&b(v),d.value=v,p.value=!0,I.start()}}function b(v){const m=document.createElement("textarea");m.value=v??"",m.style.position="absolute",m.style.opacity="0",document.body.appendChild(m),m.select(),document.execCommand("copy"),m.remove()}function h(){var v,m,L;return(L=(m=(v=document==null?void 0:document.getSelection)==null?void 0:v.call(document))==null?void 0:m.toString())!=null?L:""}function S(v){return v==="granted"||v==="prompt"}return{isSupported:c,text:d,copied:p,copy:A}}const $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P="__vueuse_ssr_handlers__",Ne=Fe();function Fe(){return P in $||($[P]=$[P]||{}),$[P]}function Re(e,t){return Ne[e]||t}function je(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const ke={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},q="vueuse-storage";function le(e,t,n,r={}){var s;const{flush:l="pre",deep:i=!0,listenToStorageChanges:o=!0,writeDefaults:a=!0,mergeDefaults:c=!1,shallow:d,window:p=B,eventFilter:I,onError:M=u=>{console.error(u)},initOnMounted:A}=r,b=(d?N:X)(typeof t=="function"?t():t),h=G(()=>x(e));if(!n)try{n=Re("getDefaultStorage",()=>{var u;return(u=B)==null?void 0:u.localStorage})()}catch(u){M(u)}if(!n)return b;const S=x(t),v=je(S),m=(s=r.serializer)!=null?s:ke[v],{pause:L,resume:k}=Me(b,()=>J(b.value),{flush:l,deep:i,eventFilter:I});H(h,()=>C(),{flush:l});let f=!1;const w=u=>{A&&!f||C(u)},E=u=>{A&&!f||O(u)};p&&o&&(n instanceof Storage?W(p,"storage",w,{passive:!0}):W(p,q,E)),A?Oe(()=>{f=!0,C()}):C();function _(u,g){if(p){const T={key:h.value,oldValue:u,newValue:g,storageArea:n};p.dispatchEvent(n instanceof Storage?new StorageEvent("storage",T):new CustomEvent(q,{detail:T}))}}function J(u){try{const g=n.getItem(h.value);if(u==null)_(g,null),n.removeItem(h.value);else{const T=m.write(u);g!==T&&(n.setItem(h.value,T),_(g,T))}}catch(g){M(g)}}function V(u){const g=u?u.newValue:n.getItem(h.value);if(g==null)return a&&S!=null&&n.setItem(h.value,m.write(S)),S;if(!u&&c){const T=m.read(g);return typeof c=="function"?c(T,S):v==="object"&&!Array.isArray(T)?{...S,...T}:T}else return typeof g!="string"?g:m.read(g)}function C(u){if(!(u&&u.storageArea!==n)){if(u&&u.key==null){b.value=S;return}if(!(u&&u.key!==h.value)){L();try{(u==null?void 0:u.newValue)!==m.write(b.value)&&(b.value=V(u))}catch(g){M(g)}finally{u?Z(k):k()}}}}function O(u){C(u.detail)}return b}async function _e(){return await $fetch("https://raw.githubusercontent.com/ByMykel/CSGO-API/main/public/api/en/skins.json",{responseType:"json"})}var D=(e=>(e.EASY="easy",e.MEDIUM="medium",e.HARD="hard",e))(D||{});const $e={easy:"3x4",medium:"4x4",hard:"5x6"};function Pe(){const e="0123456789abcdef";let t="";for(let n=0;n<8;n++)t+=e[Math.floor(Math.random()*e.length)];return t}function We(e){return function(){let t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}function De(e){let t=0;for(let n=0;n<e.length;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function Q(e,t,n){const r=t??Pe(),s=t??`${r}-${n}`,l=We(De(s)),i=[...e];for(let o=i.length-1;o>0;o--){const a=Math.floor(l()*(o+1));[i[o],i[a]]=[i[a],i[o]]}return{shuffled:i,seed:s}}const Ge=""+new URL("selected.BxcsJQ8g.mp3",import.meta.url).href,Je=""+new URL("solved.CZ6_Op3f.mp3",import.meta.url).href,R={selected:new Audio(Ge),solved:new Audio(Je)},Ve=window.setInterval,ze=pe({gameEnded:!1,gameLevel:D.EASY,gameSeed:null,gameStarted:!1,images:{data:null,error:null,pending:!1},imagesForGame:[],moves:0,scoresVisible:!1,selectedImages:[],time:0,timer:null}),y=le("cs-memory-current-session",{},localStorage),Be=le("cs-memory-scores",[],localStorage);function Ye(){const{gameEnded:e,gameLevel:t,gameSeed:n,gameStarted:r,images:s,imagesForGame:l,moves:i,scoresVisible:o,selectedImages:a,time:c,timer:d}=me(ze);async function p(){s.value.pending=!0;try{const f=await _e();f&&(s.value.data=f)}catch(f){f&&(s.value.error=f)}finally{setTimeout(()=>{s.value.pending=!1},1e3)}y.value&&F(y.value.gameSeed)&&F(y.value.gameLevel)&&F(y.value.moves)&&F(y.value.solvedImages)&&F(y.value.time)&&(n.value=y.value.gameSeed,t.value=y.value.gameLevel,i.value=y.value.moves,c.value=y.value.time,I(!1))}function I(f=!1){if(s.value.data){if(f&&(n.value=null),!A()){j&&U().$toast.error("Niepoprawny seed",{position:"top-center"});return}const[w,E]=$e[t.value].split("x").map(Number),_=w*E,{seed:J,shuffled:V}=Q(s.value.data,n.value,t.value);n.value=J;const C=[...V.slice(0,_/2)];l.value=Q([...C,...C.map(O=>({...O,id:`${O.id}----copy`}))],n.value,t.value).shuffled,y.value&&F(y.value.solvedImages)&&l.value.forEach(O=>{var u;(u=y.value.solvedImages)!=null&&u.includes(O.id)&&(O.solved=!0)}),r.value=!0,l.value.every(O=>O.solved)||S()}}function M(){e.value=!1,t.value=D.EASY,n.value=null,r.value=!1,i.value=0,c.value=0,a.value=[],y.value={},l.value.forEach(f=>{f.solved=!1}),v()}function A(){if(n.value){const f=n.value.split("-"),w=f[f.length-1];return Object.values(D).includes(w)?(t.value=w,!0):!1}return!0}function b(f){if(a.value.length===2||l.value.every(E=>E.solved))return;R.selected.pause(),R.selected.currentTime=0,R.selected.play(),i.value++;const w=a.value.find(E=>E.id===f.id);w?(a.value.splice(a.value.indexOf(w),1),w.selected=!1):(f.selected=!0,a.value.push(f)),a.value.length===2&&(a.value[0].id.replace("----copy","")===a.value[1].id.replace("----copy","")&&(R.solved.pause(),R.solved.currentTime=0,R.solved.play(),a.value.forEach(E=>E.solved=!0)),setTimeout(()=>{a.value.forEach(E=>E.selected=!1),a.value=[]},500)),h()}function h(){l.value.every(f=>f.solved)&&(m(),v(),setTimeout(()=>{j&&U().$toast.success("gratulacje!",{position:"top-center"})},500),setTimeout(()=>{e.value=!0},1500))}function S(){d.value=Ve(()=>{m(),c.value++},1e3)}function v(){d.value&&clearInterval(d.value)}function m(){y.value={gameSeed:n.value,gameLevel:t.value,moves:i.value,solvedImages:l.value.filter(f=>f.solved).map(f=>f.id),time:c.value}}function L(f){const w={date:new Date().toISOString(),userName:f,gameLevel:t.value,moves:i.value,time:c.value};Be.value.push(w),e.value=!1}function k(){o.value=!0}return{gameEnded:e,gameLevel:t,gameSeed:n,gameStarted:r,images:s,imagesForGame:l,moves:i,scoresVisible:o,selectedImages:a,time:c,fetchImages:p,saveScore:L,selectImage:b,showScores:k,startGame:I,resetGame:M,trySetGameLevel:A}}const qe=e=>{const t=Math.floor(e/3600).toString().padStart(2,"0"),n=Math.floor(e%3600/60).toString().padStart(2,"0"),r=(e%60).toString().padStart(2,"0");return`${t}:${n}:${r}`};export{le as a,Ue as b,qe as f,$e as g,Ye as u};
